# News Aggregator v2.0

–ü—Ä–æ–¥–∞–∫—à–Ω —Å–∏—Å—Ç–µ–º–∞ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –Ω–æ–≤–æ—Å—Ç–µ–π —Å –ò–ò-—Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–µ–π, –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º –∏ –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö PostgreSQL.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫

### Docker (–ü—Ä–æ–¥–∞–∫—à–Ω)
```bash
cd v2
docker-compose up -d
```

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
```bash
cd v2
pip install -r requirements.txt
python -m news_aggregator
```

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- **`news_aggregator/`** - FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å async –æ–±—Ä–∞–±–æ—Ç–∫–æ–π
- **`web/`** - HTML —à–∞–±–ª–æ–Ω—ã –∏ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
- **`db/`** - PostgreSQL —Å—Ö–µ–º–∞ (–∞–≤—Ç–æ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è)
- **`docker/`** - Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è dev/prod
- **`scripts/`** - –£—Ç–∏–ª–∏—Ç—ã –±—ç–∫–∞–ø–∞ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫
- **Backend**: FastAPI + SQLAlchemy + asyncpg
- **Database**: PostgreSQL 15
- **Frontend**: Jinja2 + vanilla JS/CSS
- **Deployment**: Docker + Nginx
- **AI**: Constructor KM API integration

## ‚úÖ –°—Ç–∞—Ç—É—Å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –ü–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–æ
- [x] **–ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** - core, services, sources
- [x] **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** - PostgreSQL —Å –ø–æ–ª–Ω–æ–π —Å—Ö–µ–º–æ–π (9 —Ç–∞–±–ª–∏—Ü)
- [x] **–í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** - –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å + –ø—É–±–ª–∏—á–Ω—ã–π API
- [x] **Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è** - dev/prod –æ–∫—Ä—É–∂–µ–Ω–∏—è
- [x] **–°–∏—Å—Ç–µ–º–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤** - Plugin –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (RSS, Telegram, Generic)
- [x] **AI –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** - Constructor KM API —Å rate limiting
- [x] **AI-enhanced –∫–æ–Ω—Ç–µ–Ω—Ç —ç–∫—Å—Ç—Ä–∞–∫—Ü–∏—è** - –ü—É–±–ª–∏–∫–∞—Ü–∏—è –¥–∞—Ç, –ø–æ–ª–Ω—ã–µ —Å—Ç–∞—Ç—å–∏
- [x] **–†–µ–∫–ª–∞–º–∞ detection** - –ò–ò-–¥–µ—Ç–µ–∫—Ü–∏—è —Ä–µ–∫–ª–∞–º—ã –≤ Telegram –∫–∞–Ω–∞–ª–∞—Ö
- [x] **Telegraph –ø—É–±–ª–∏–∫–∞—Ü–∏—è** - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—É–±–ª–∏–∫–∞—Ü–∏—è —Å—Ç–∞—Ç–µ–π
- [x] **Backup —Å–∏—Å—Ç–µ–º–∞** - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã –ë–î
- [x] **Async –æ–±—Ä–∞–±–æ—Ç–∫–∞** - –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ
- [x] **CLI –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É

### –ß–∞—Å—Ç–∏—á–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- [x] **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - Prometheus –º–µ—Ç—Ä–∏–∫–∏ (—á–∞—Å—Ç–∏—á–Ω–æ)
- [x] **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ë–∞–∑–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ structlog

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–µ–ª—ã
- [ ] **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - 0% –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏
- [ ] **GitHub Actions** - Workflows –Ω–µ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω—ã
- [ ] **API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** - OpenAPI –Ω–µ–ø–æ–ª–Ω–∞—è

## üíª –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- **–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ (–Ω–æ–≤–æ—Å—Ç–∏)**: http://localhost:8000
- **–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å**: http://localhost:8000/admin (–∑–∞—â–∏—â–µ–Ω–∞ –ø–∞—Ä–æ–ª–µ–º)
- **API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: http://localhost:8000/docs  
- **API endpoints**: http://localhost:8000/api/*
- **–°—Ç–∞—Ç—É—Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏**: http://localhost:8000/auth-status

### CLI –∫–æ–º–∞–Ω–¥—ã
```bash
# –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–æ–≤–æ—Å—Ç–µ–π
python -m news_aggregator.cli process

# –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏
python -m news_aggregator.cli sources list
python -m news_aggregator.cli sources add --name "Habr" --type rss --url "https://habr.com/rss/"

# –°–∏—Å—Ç–µ–º–∞ –±—ç–∫–∞–ø–æ–≤
./scripts/backup.sh
./scripts/restore.sh <backup_path>

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
python -m news_aggregator.cli stats
```

### API Integration
```python
# –ü—Ä–æ–≥—Ä–∞–º–º–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ API
import aiohttp

async def get_news():
    async with aiohttp.ClientSession() as session:
        async with session.get('http://localhost:8000/api/feed') as resp:
            return await resp.json()
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
DATABASE_URL=postgresql://user:pass@localhost:5432/newsdb
CONSTRUCTOR_KM_API=https://training.constructor.app/api/platform-kmapi/v1/knowledge-models/your-model-id/chat/completions/direct_llm
CONSTRUCTOR_KM_API_KEY=Bearer your_api_key_here
TELEGRAM_TOKEN=your_bot_token
TELEGRAM_CHAT_ID=your_chat_id

# –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∞–¥–º–∏–Ω–∫–∏ (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û!)
ADMIN_USERNAME=admin
ADMIN_PASSWORD=your_secure_password

# AI –º–æ–¥–µ–ª–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∑–∞–¥–∞—á
SUMMARIZATION_MODEL=gpt-4o-mini    # –°—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—è —Å—Ç–∞—Ç–µ–π
CATEGORIZATION_MODEL=gpt-4o-mini   # –ö–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è –Ω–æ–≤–æ—Å—Ç–µ–π
DIGEST_MODEL=gpt-4.1               # –§–∏–Ω–∞–ª—å–Ω—ã–µ –¥–∞–π–¥–∂–µ—Å—Ç—ã
```

### Docker Compose Override
```bash
cp docker-compose.override.yml.example docker-compose.override.yml
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **CLAUDE.md** - –ü–æ–ª–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- **QUICKSTART.md** - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
- **BACKUP_SYSTEM.md** - –°–∏—Å—Ç–µ–º–∞ –±—ç–∫–∞–ø–æ–≤ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
- **MIGRATION_GUIDE.md** - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
- **CONTENT_EXTRACTOR_IMPROVEMENTS.md** - AI-enhanced —ç–∫—Å—Ç—Ä–∞–∫—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- **AI_ENHANCEMENTS.md** - –°–∏—Å—Ç–µ–º–∞ –ò–ò-—É–ª—É—á—à–µ–Ω–∏–π –∏ –¥–µ—Ç–µ–∫—Ü–∏–∏ —Ä–µ–∫–ª–∞–º—ã

## üêõ –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ç–µ—Å—Ç–æ–≤** - –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–æ–±–µ–ª, —Ç—Ä–µ–±—É–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏—è pytest
2. **GitHub Actions** - Workflows –Ω–µ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω—ã –ø–æ–¥ –Ω–æ–≤—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É
3. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - Prometheus –º–µ—Ç—Ä–∏–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã —á–∞—Å—Ç–∏—á–Ω–æ

## ü§ù –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç

1. Fork —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
2. –°–æ–∑–¥–∞–π—Ç–µ feature branch
3. –î–æ–±–∞–≤—å—Ç–µ —Ç–µ—Å—Ç—ã –¥–ª—è –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
4. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ—Ö–æ–¥—è—Ç
5. –°–æ–∑–¥–∞–π—Ç–µ Pull Request

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

[–£–∫–∞–∂–∏—Ç–µ –ª–∏—Ü–µ–Ω–∑–∏—é –ø—Ä–æ–µ–∫—Ç–∞]