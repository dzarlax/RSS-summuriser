# RSS Summarizer v2 - Migration Guide

## üöÄ –ü–µ—Ä–µ–Ω–æ—Å —Å–µ—Ä–≤–∏—Å–∞ –Ω–∞ –Ω–æ–≤—ã–π —Å–µ—Ä–≤–µ—Ä

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **Docker** –∏ **Docker Compose** —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –Ω–∞ –Ω–æ–≤–æ–º —Å–µ—Ä–≤–µ—Ä–µ
- **Git** –¥–ª—è –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
- –î–æ—Å—Ç—É–ø –∫ —Ñ–∞–π–ª–∞–º —Ç–µ–∫—É—â–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞

---

## üì¶ –ú–µ—Ç–æ–¥ 1: –ü–æ–ª–Ω—ã–π –ø–µ—Ä–µ–Ω–æ—Å —á–µ—Ä–µ–∑ backup

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –Ω–∞ —Ç–µ–∫—É—â–µ–º —Å–µ—Ä–≤–µ—Ä–µ

```bash
cd /path/to/rss-summarizer/v2

# –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ –±—ç–∫–∞–ø–∞
make backup

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
ls -la backups/
```

–†–µ–∑—É–ª—å—Ç–∞—Ç: –∞—Ä—Ö–∏–≤ `news_aggregator_backup_YYYYMMDD_HHMMSS.tar.gz`

### 2. –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –Ω–æ–≤—ã–π —Å–µ—Ä–≤–µ—Ä

```bash
# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∞—Ä—Ö–∏–≤ –Ω–∞ –Ω–æ–≤—ã–π —Å–µ—Ä–≤–µ—Ä
scp backups/news_aggregator_backup_*.tar.gz user@new-server:/tmp/

# –°–∫–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
ssh user@new-server
git clone <your-repository> /path/to/rss-summarizer
cd /path/to/rss-summarizer/v2

# –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –∞—Ä—Ö–∏–≤
mv /tmp/news_aggregator_backup_*.tar.gz ./backups/
```

### 3. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞ –Ω–æ–≤–æ–º —Å–µ—Ä–≤–µ—Ä–µ

```bash
# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –∞—Ä—Ö–∏–≤–∞
make restore BACKUP=./backups/news_aggregator_backup_*.tar.gz

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã
make prod
```

---

## üì§ –ú–µ—Ç–æ–¥ 2: –ú–∏–≥—Ä–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã—Ö

### 1. –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Ç–µ–∫—É—â–µ–º —Å–µ—Ä–≤–µ—Ä–µ

```bash
cd /path/to/rss-summarizer/v2

# –≠–∫—Å–ø–æ—Ä—Ç –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
make export

# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
cp .env .env.backup
cp docker-compose.yml docker-compose.yml.backup

# –ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
tar -czf app_data.tar.gz data/ logs/ 2>/dev/null || true
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–∞ –Ω–æ–≤–æ–º —Å–µ—Ä–≤–µ—Ä–µ

```bash
# –°–∫–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
git clone <your-repository> /path/to/rss-summarizer
cd /path/to/rss-summarizer/v2

# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
scp user@old-server:/path/to/.env.backup .env
scp user@old-server:/path/to/docker-compose.yml.backup docker-compose.yml
scp user@old-server:/path/to/exports/migration_*.sql ./exports/
scp user@old-server:/path/to/app_data.tar.gz ./

# –†–∞—Å–ø–∞–∫–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
tar -xzf app_data.tar.gz 2>/dev/null || true

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã
make prod

# –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
make import FILE=./exports/migration_*.sql
```

---

## üóÇÔ∏è –ß—Ç–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–Ω–æ—Å–µ

### ‚úÖ **–ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**

1. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö PostgreSQL**
   - –í—Å–µ —Å—Ç–∞—Ç—å–∏ —Å —Ä–µ–∑—é–º–µ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
   - –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –Ω–æ–≤–æ—Å—Ç–µ–π (RSS, Telegram –∫–∞–Ω–∞–ª—ã)
   - –ö–ª–∞—Å—Ç–µ—Ä—ã –Ω–æ–≤–æ—Å—Ç–µ–π –∏ –¥–∞–π–¥–∂–µ—Å—Ç—ã
   - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏

2. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–∞**
   - –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (`.env`)
   - Docker Compose –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
   - –ú–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (`./db/`)

3. **–î–∞–Ω–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è**
   - –õ–æ–≥–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ (`./logs/`)
   - –ö–µ—à –∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (`./data/`)
   - –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–µ —Ç–æ–º–∞ Docker

### ‚öôÔ∏è **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è:**

- **–ò—Å—Ç–æ—á–Ω–∏–∫–∏ –Ω–æ–≤–æ—Å—Ç–µ–π** - –≤—Å–µ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ Telegram –∫–∞–Ω–∞–ª—ã –∏ RSS —Ñ–∏–¥—ã
- **–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å—Ç–∞—Ç–µ–π** - Business, Tech, Science, Nature, Serbia, Marketing, Other
- **–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–æ–≤–æ—Å—Ç–µ–π
- **AI –Ω–∞—Å—Ç—Ä–æ–π–∫–∏** - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏–∏

---

## üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –±—ç–∫–∞–ø–æ–≤

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –±—ç–∫–∞–ø–æ–≤

–î–æ–±–∞–≤—å—Ç–µ –≤ crontab –¥–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –±—ç–∫–∞–ø–æ–≤:

```bash
crontab -e

# –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –±—ç–∫–∞–ø –≤ 3:00 –Ω–æ—á–∏
0 3 * * * cd /path/to/rss-summarizer/v2 && make backup > /var/log/rss-backup.log 2>&1

# –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –±—ç–∫–∞–ø–æ–≤ (—Å—Ç–∞—Ä—à–µ 30 –¥–Ω–µ–π)
0 4 * * 0 cd /path/to/rss-summarizer/v2 && make cleanup-backups
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±—ç–∫–∞–ø–æ–≤

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –±—ç–∫–∞–ø–æ–≤
make list-backups

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
make db-size

# –ü—Ä–æ–≤–µ—Ä–∫–∞ Docker —Ç–æ–º–æ–≤
make volumes-list
```

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤

```bash
# –°—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker-compose ps

# –õ–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
make logs

# –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
curl -I http://localhost:8000
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö

```bash
# –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
curl -s http://localhost:8000/api/v1/sources | jq '.sources | length'

# –ü–æ—Å–ª–µ–¥–Ω–∏–µ —Å—Ç–∞—Ç—å–∏
curl -s http://localhost:8000/api/v1/feed?limit=5

# –ü—Ä–æ–≤–µ—Ä–∫–∞ Telegram –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
make process
```

### 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π

- **–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å**: http://localhost:8000/admin
- **API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: http://localhost:8000/docs
- **–ü—É–±–ª–∏—á–Ω–∞—è –ª–µ–Ω—Ç–∞**: http://localhost:8000

---

## üõ†Ô∏è Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –Ω–µ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
docker-compose logs

# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –æ–±—Ä–∞–∑—ã
docker-compose down
docker-compose build --no-cache
docker-compose up -d
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL
make db-shell

# –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
docker-compose down
docker volume rm v2_postgres_data
docker-compose up -d postgres

# –ü–æ–≤—Ç–æ—Ä–∏—Ç—å –∏–º–ø–æ—Ä—Ç
make import FILE=./exports/migration_*.sql
```

### –ü—Ä–æ–±–ª–µ–º–∞: Telegram –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å Telegram
curl -I https://t.me/s/channelname

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏
make logs | grep -i telegram

# –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫
curl http://localhost:8000/api/v1/sources/1/test
```

---

## üìã –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–µ—Ä–µ–Ω–æ—Å–∞

### –£–ø—Ä–æ—â–µ–Ω–Ω—ã–π –ø–µ—Ä–µ–Ω–æ—Å –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π

–ù–∞ —Å—Ç–∞—Ä–æ–º —Å–µ—Ä–≤–µ—Ä–µ:
```bash
make migration-prepare
```

–ù–∞ –Ω–æ–≤–æ–º —Å–µ—Ä–≤–µ—Ä–µ:
```bash
git clone <repo> rss-summarizer
cd rss-summarizer/v2
make restore BACKUP=backup.tar.gz
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–æ–≥–æ –ø–µ—Ä–µ–Ω–æ—Å–∞

```bash
# –û–¥–∏–Ω —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø–æ–ª–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
curl -f http://localhost:8000/api/v1/sources && \
curl -f http://localhost:8000/api/v1/feed?limit=1 && \
echo "‚úÖ Migration successful!" || \
echo "‚ùå Migration failed!"
```

---

## ‚ö° Performance Tips

### –ü–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏

1. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è PostgreSQL**
```bash
docker exec v2-postgres-1 psql -U newsuser -d newsdb -c "VACUUM ANALYZE;"
```

2. **–û—á–∏—Å—Ç–∫–∞ Docker**
```bash
docker system prune -f
```

3. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ—Å—É—Ä—Å–æ–≤**
```bash
docker stats
make db-size
```

---

**üéØ –í–∞—à —Å–µ—Ä–≤–∏—Å —Ç–µ–ø–µ—Ä—å –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–Ω–æ—Å–∏–º!**

–í–µ—Å—å –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–Ω–∏–º–∞–µ—Ç 5-10 –º–∏–Ω—É—Ç –∏ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö, –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∏ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–∞ –Ω–∞ –Ω–æ–≤–æ–º —Å–µ—Ä–≤–µ—Ä–µ. 