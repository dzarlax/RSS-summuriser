# üöÄ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –º–∏–≥—Ä–∞—Ü–∏—è –¥–ª—è Synology

## üìã –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è RSS Summarizer v2 –Ω–∞ Synology NAS. –ú–∏–≥—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç —Ä—É—á–Ω–æ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞.

## ‚ú® –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- **üîç –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ** - —Å–∏—Å—Ç–µ–º–∞ —Å–∞–º–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –Ω—É–∂–Ω–∞ –ª–∏ –º–∏–≥—Ä–∞—Ü–∏—è
- **‚ö° –ë—ã—Å—Ç—Ä–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ** - –º–∏–≥—Ä–∞—Ü–∏—è –∑–∞–Ω–∏–º–∞–µ—Ç 10-30 —Å–µ–∫—É–Ω–¥
- **üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- **üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - API endpoints –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞
- **üîÑ –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å** - –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ –±–µ–∑ –≤—Ä–µ–¥–∞

## üéØ –ß—Ç–æ –º–∏–≥—Ä–∏—Ä—É–µ—Ç—Å—è

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:
1. **–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–∞–±–ª–∏—Ü** (`categories`, `article_categories`)
2. **–ú–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–æ—Å—Ç—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π** (`Business`, `Tech`, `Serbia`, etc.)
3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ—Å—Ç–∞–≤–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π** (`Business|Tech` ‚Üí Business + Tech)
4. **–°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤** –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –¢–∏–ø—ã —Å–æ—Å—Ç–∞–≤–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π:
- `Business|Tech` ‚Üí Business AND Tech
- `Serbia/Business` ‚Üí Serbia AND Business  
- `Tech,Science` ‚Üí Tech AND Science
- `Serbia & Tech` ‚Üí Serbia AND Tech
- `Business and Science` ‚Üí Business AND Science

## üîß –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:
```
üîç Checking for database migrations...
‚úÖ Applied 1 migrations
   - 002_multiple_categories: Add support for multiple categories per article
```

### –õ–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏:
1. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü `categories` –∏ `article_categories`
2. –ò—â–µ—Ç —Å–æ—Å—Ç–∞–≤–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –≤ –ø–æ–ª–µ `articles.category`
3. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç–∞—Ç—å–∏ –±–µ–∑ —Å–≤—è–∑–µ–π –≤ `article_categories`
4. –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–∞–π–¥–µ–Ω–æ ‚Üí –∑–∞–ø—É—Å–∫–∞–µ—Ç –º–∏–≥—Ä–∞—Ü–∏—é

## üì° API –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –º–∏–≥—Ä–∞—Ü–∏–∏:
```bash
curl http://localhost:8000/api/v1/migrations/status
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "migration_needed": false,
  "tables_exist": {
    "categories": true,
    "article_categories": true
  },
  "statistics": {
    "articles_with_categories": 837,
    "category_relationships": 822
  },
  "available_migrations": ["002_multiple_categories"]
}
```

### –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ –º–∏–≥—Ä–∞—Ü–∏–∏:
```bash
curl -X POST http://localhost:8000/api/v1/migrations/run
```

## üöÄ –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞ Synology

### –®–∞–≥ 1: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞
```bash
# –í –ø–∞–ø–∫–µ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ Synology
git pull origin main
```

### –®–∞–≥ 2: –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
```bash
# –ß–µ—Ä–µ–∑ Docker UI –≤ DSM –∏–ª–∏ –∫–æ–º–∞–Ω–¥–æ–π:
docker compose restart app
```

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –º–∏–≥—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–∏–ª–∞—Å—å
docker logs your-app-container --tail 50 | grep -i migration
```

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:**
```
üîç Checking for database migrations...
‚úÖ Applied 1 migrations
   - 002_multiple_categories: Add support for multiple categories per article
```

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å API –∫–∞—Ç–µ–≥–æ—Ä–∏–π
curl http://localhost:8000/api/v1/categories

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—å–∏ —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
curl http://localhost:8000/api/v1/feed?limit=1
```

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–∏–≥—Ä–∞—Ü–∏–∏

### –î–æ –º–∏–≥—Ä–∞—Ü–∏–∏:
```json
{
  "article_id": 123,
  "category": "Business|Tech",  // –ü—Ä–æ–±–ª–µ–º–Ω–∞—è —Å–æ—Å—Ç–∞–≤–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è
  "categories": null
}
```

### –ü–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏:
```json
{
  "article_id": 123,
  "category": "Business",  // –ü–µ—Ä–≤–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è (legacy)
  "categories": [
    {
      "name": "Business",
      "display_name": "–ë–∏–∑–Ω–µ—Å",
      "confidence": 1.0,
      "color": "#28a745"
    },
    {
      "name": "Tech", 
      "display_name": "–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏",
      "confidence": 1.0,
      "color": "#007bff"
    }
  ]
}
```

## ‚ö†Ô∏è –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ü—Ä–æ–±–ª–µ–º–∞: –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
curl http://localhost:8000/api/v1/migrations/status

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Ä—É—á–Ω—É—é
curl -X POST http://localhost:8000/api/v1/migrations/run
```

### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∏ –≤ –ª–æ–≥–∞—Ö
**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏
docker logs your-app-container --tail 100

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
docker exec your-app-container python -c "from news_aggregator.database import AsyncSessionLocal; print('DB OK')"
```

### –ü—Ä–æ–±–ª–µ–º–∞: –°–æ—Å—Ç–∞–≤–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –æ—Å—Ç–∞–ª–∏—Å—å
**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –ø–æ–≤—Ç–æ—Ä–Ω–æ
curl -X POST http://localhost:8000/api/v1/migrations/run

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
curl http://localhost:8000/api/v1/migrations/status
```

## üîÑ –û—Ç–∫–∞—Ç (–µ—Å–ª–∏ –Ω—É–∂–µ–Ω)

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π backup –Ω–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è
–î–ª—è Synology —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Å–æ–∑–¥–∞—Ç—å backup –≤—Ä—É—á–Ω—É—é –ø–µ—Ä–µ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º:

```bash
# –°–æ–∑–¥–∞—Ç—å backup –ë–î
docker exec your-db-container pg_dump -U postgres news_aggregator > backup_$(date +%Y%m%d).sql

# –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –æ—Ç–∫–∞—Ç–∞:
docker exec -i your-db-container psql -U postgres news_aggregator < backup_YYYYMMDD.sql
```

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞

–ú–∏–≥—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞ –µ—Å–ª–∏:
- [x] –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–ø—É—Å—Ç–∏–ª—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- [x] –í –ª–æ–≥–∞—Ö –µ—Å—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ "Applied 1 migrations"
- [x] API `/api/v1/categories` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å —Ü–≤–µ—Ç–∞–º–∏
- [x] API `/api/v1/feed` –≤–∫–ª—é—á–∞–µ—Ç –ø–æ–ª–µ `categories` 
- [x] –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

### –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:
```bash
# –°—Ç–∞—Ç—É—Å –º–∏–≥—Ä–∞—Ü–∏–∏
curl http://localhost:8000/api/v1/migrations/status

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
curl http://localhost:8000/api/v1/categories

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç–µ–π
curl "http://localhost:8000/api/v1/feed?limit=1" | jq '.items[0].categories'

# –õ–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
docker logs your-app-container --tail 50

# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
docker exec -it your-db-container psql -U postgres news_aggregator
```

### SQL –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:
```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–∞–±–ª–∏—Ü—ã
\dt

-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
SELECT c.display_name, COUNT(ac.article_id) 
FROM categories c 
LEFT JOIN article_categories ac ON c.id = ac.category_id 
GROUP BY c.display_name;

-- –°—Ç–∞—Ç—å–∏ —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
SELECT article_id, COUNT(*) as categories_count 
FROM article_categories 
GROUP BY article_id 
HAVING COUNT(*) > 1 
LIMIT 10;
```

---

**–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–º—É —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—é –Ω–∞ Synology! üéâ**

**–í—Ä–µ–º—è –º–∏–≥—Ä–∞—Ü–∏–∏:** ~10-30 —Å–µ–∫—É–Ω–¥  
**Downtime:** –¢–æ–ª—å–∫–æ –≤—Ä–µ–º—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (~5-10 —Å–µ–∫—É–Ω–¥)  
**–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** –í—ã—Å–æ–∫–∞—è (–Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–ø—É—Å–∫ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö)
